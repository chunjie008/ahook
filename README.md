# AHOOK - 加密操作监控Xposed模块

## 简介
AHOOK 是一个基于 Xposed 框架开发的模块，旨在监控 Android 应用程序内部的常见加密操作，包括哈希（MessageDigest）、消息认证码（Mac/HMAC）和加解密（Cipher）。它能够记录这些操作的输入数据、输出结果、使用的密钥、IV（初始化向量）以及调用堆栈等关键信息，以帮助开发者和安全研究人员分析应用的加密行为。

## 功能特性
*   **MessageDigest 监控**: 捕获包括 MD5, SHA-1, SHA-256 等在内的各种哈希算法的输入数据和计算结果。
*   **Mac (HMAC) 监控**: 记录 HMAC 算法的输入数据、计算结果和使用的密钥。
*   **Cipher 监控**: 详细记录 AES, DES, RSA 等加解密操作的输入数据、输出结果、密钥、IV 和算法模式。
*   **详细日志**: 记录操作的时间戳、日志名称、包名、应用名称及完整的调用堆栈，便于溯源分析。
*   **多格式输出**: 输入输出数据支持 UTF-8 字符串、Hex（十六进制）和 Base64 编码显示，方便查看。
*   **轻量高效**: 采用 WeakHashMap 优化内存使用，减少对目标应用性能的影响。

## 为什么要重复造轮子
*   此类软件已经有算法助手，算法助手功能更强，但是闭源，无法再此上添加接口

### 前提条件
*   已Root的Android设备。
*   已安装 Xposed 框架或其兼容实现（如 LSPosed, EdXposed 等）。

### 安装步骤
1.  **下载 APK**: 从 [此处填写发布页面或下载链接，例如GitHub Releases] 下载最新版本的 `AI_TOOLS.apk`。
2.  **安装 APK**: 将下载的 APK 文件安装到您的 Android 设备上。
3.  **激活模块**:
    *   打开您的 Xposed/LSPosed 管理器应用。
    *   在模块列表中找到 "AI_TOOLS" 并勾选激活。
    *   选择您希望监控的应用程序。
4.  **重启设备**: 激活模块后，请务必重启您的 Android 设备，以使模块生效。

## 使用方法
1.  在 Xposed/LSPosed 管理器中，确保 AI_TOOLS 模块已为目标应用程序激活。
2.  运行目标应用程序，执行需要监控的加密操作。
3.  日志信息将通过 Android 的 ContentProvider 存储在设备内部。您可以通过开发一个配套应用或者通过 adb shell 命令（如 `content query` 命令，但需要知道 ContentProvider 的URI和列名）来访问和查看这些日志。

## 免责声明
本工具仅供学习、研究和安全分析使用。请勿将其用于任何非法目的。因滥用本工具而产生的一切后果，由使用者自行承担。开发者不对任何非法使用行为负责。

## 贡献
欢迎提交 Pull Request 或 Issues 来改进本工具。

##
作者:water

##
qq群:1037044062

## 许可证
本项目采用 GNU General Public License v3.0 (GPLv3) 许可。有关详细信息，请参阅 LICENSE 文件。
